# -*- coding: utf-8 -*-
"""Travel Prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1U3RfksgPDNWXD5pWSkUCa-qtU-cajbxF
"""

import numpy as np

def sigmoid(x):
 return 1 / (1+np.exp(-x))

def neuron(weather, free_time):
  w1 = 5
  w2 = 5
  bias = -8

  total = (weather * w1) + (free_time * w2) + bias
  return sigmoid(total)

print("อากาศแย่, ไม่ว่าง ->" , neuron(0,0))
print("อากาศดี, ไม่ว่าง ->" , neuron(1,0))
print("อากาศดี, ว่าง ->" , neuron(1,1))

import torch
import torch.nn as nn
import torch.optim as optim

x = torch.tensor([[0., 0.],
 [0.,1.],
  [1.,0.],
   [1.,1.,]])
# x = Input

#  y = target
y = torch.tensor([[0.],
 [0.],
  [0.],
   [1.]])


model = nn.Sequential (nn.Linear(2,1) , nn.Sigmoid() )

criterion = nn.MSELoss()
optimizer = optim.SGD(model.parameters() , lr = 0.1)

epochs = 10000

for i in range(epochs):
  prediction = model(x)

  loss = criterion(prediction, y)

  optimizer.zero_grad
  loss.backward()
  optimizer.step()

  if i % 1000 == 0:
    print(f"รอบที่ {i}, ความผิดพลาด (Error) : {loss.item()}")

test = torch.tensor([1.,1.])
print("result:", model(test).item())

test = torch.tensor([0.,1.])
print("result:", model(test).item())